Option Explicit


Function Get_Folder_On_Win() As String

Dim folderPath As String
Dim fileExplorer As FileDialog

On Error GoTo err
Set fileExplorer = Application.FileDialog(msoFileDialogFolderPicker)

fileExplorer.AllowMultiSelect = False
With fileExplorer
    If .Show = -1 Then 'Any folder is selected
        folderPath = .SelectedItems.Item(1)
    End If
End With
err:

Select_Folder_On_Win = folderPath
End Function



Function Get_Folder_On_Mac() As String
Dim folderPath As String
Dim RootFolder As String
Dim scriptstr As String

On Error Resume Next
RootFolder = MacScript("return (path to desktop folder) as String")
'Or use RootFolder = "Macintosh HD:Users:YourUserName:Desktop:TestMap:"
'Note : for a fixed path use : as seperator in 2011 and 2016

If Val(Application.Version) < 15 Then
    scriptstr = "(choose folder with prompt ""Select the folder""" & _
    " default location alias """ & RootFolder & """) as string"
Else
    scriptstr = "return posix path of (choose folder with prompt ""Select the folder""" & _
    " default location alias """ & RootFolder & """) as string"
End If

folderPath = MacScript(scriptstr)
On Error GoTo 0

Select_Folder_On_Mac = folderPath
End Function


Function Get_File_Mac() As String
Dim MyPath As String
Dim MyScript As String
Dim MyFiles As String


'"{""org.openxmlformats.spreadsheetml.sheet""}" & _
'"{""public.comma-separated-values-text""}" & _

MyPath = ThisWorkbook.Path

MyScript = _
"set AppleScript's text item delimiters to "","" " & vbNewLine & _
           "set theFiles to (choose file of type " & _
          "{""org.openxmlformats.spreadsheetml.sheet""}" & _
           "with prompt ""Please select a file or files"" default location (path to desktop) multiple selections allowed false) as string" & vbNewLine & _
           "set AppleScript's text item delimiters to """" " & vbNewLine & _
           "return theFiles"

On Error Resume Next
MyFiles = MacScript(MyScript)
On Error GoTo 0

If MyFiles <> "" Then MyFiles = Replace(Replace(MyFiles, Split(MyFiles, ":")(0), ""), ":", Application.PathSeparator)
Get_File_Mac = MyFiles
    
End Function

Function Get_File_Win()
Dim lngCount As Long
With Application.FileDialog(msoFileDialogOpen)
    .InitialFileName = ThisWorkbook.Path
    .AllowMultiSelect = False
    .Show
    For lngCount = 1 To .SelectedItems.Count
        Get_File_Win = .SelectedItems(lngCount)
    Next lngCount
End With
End Function


